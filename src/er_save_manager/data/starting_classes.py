"""
Elden Ring Starting Class Base Stats

Each class has base stats that determine the starting level.
Archetype values from the game.
"""

STARTING_CLASSES = {
    0: {
        "name": "Vagabond",
        "level": 9,
        "vigor": 15,
        "mind": 10,
        "endurance": 11,
        "strength": 14,
        "dexterity": 13,
        "intelligence": 9,
        "faith": 9,
        "arcane": 7,
    },
    1: {
        "name": "Warrior",
        "level": 8,
        "vigor": 11,
        "mind": 12,
        "endurance": 11,
        "strength": 10,
        "dexterity": 16,
        "intelligence": 10,
        "faith": 8,
        "arcane": 9,
    },
    2: {
        "name": "Hero",
        "level": 7,
        "vigor": 14,
        "mind": 9,
        "endurance": 12,
        "strength": 16,
        "dexterity": 9,
        "intelligence": 7,
        "faith": 8,
        "arcane": 11,
    },
    3: {
        "name": "Bandit",
        "level": 5,
        "vigor": 10,
        "mind": 11,
        "endurance": 10,
        "strength": 9,
        "dexterity": 13,
        "intelligence": 9,
        "faith": 8,
        "arcane": 14,
    },
    4: {
        "name": "Astrologer",
        "level": 6,
        "vigor": 9,
        "mind": 15,
        "endurance": 9,
        "strength": 8,
        "dexterity": 12,
        "intelligence": 16,
        "faith": 7,
        "arcane": 9,
    },
    5: {
        "name": "Prophet",
        "level": 7,
        "vigor": 10,
        "mind": 14,
        "endurance": 8,
        "strength": 11,
        "dexterity": 10,
        "intelligence": 7,
        "faith": 16,
        "arcane": 10,
    },
    6: {
        "name": "Samurai",
        "level": 9,
        "vigor": 12,
        "mind": 11,
        "endurance": 13,
        "strength": 12,
        "dexterity": 15,
        "intelligence": 9,
        "faith": 8,
        "arcane": 8,
    },
    7: {
        "name": "Prisoner",
        "level": 9,
        "vigor": 11,
        "mind": 12,
        "endurance": 11,
        "strength": 11,
        "dexterity": 14,
        "intelligence": 14,
        "faith": 6,
        "arcane": 9,
    },
    8: {
        "name": "Confessor",
        "level": 10,
        "vigor": 10,
        "mind": 13,
        "endurance": 10,
        "strength": 12,
        "dexterity": 12,
        "intelligence": 9,
        "faith": 14,
        "arcane": 9,
    },
    9: {
        "name": "Wretch",
        "level": 1,
        "vigor": 10,
        "mind": 10,
        "endurance": 10,
        "strength": 10,
        "dexterity": 10,
        "intelligence": 10,
        "faith": 10,
        "arcane": 10,
    },
}

CONVERGENCE_STARTING_CLASSES = {
    0: {
        "name": "Retainer",
        "level": 9,
        "vigor": 15,
        "mind": 10,
        "endurance": 11,
        "strength": 14,
        "dexterity": 13,
        "intelligence": 9,
        "faith": 9,
        "arcane": 7,
    },
    1: {
        "name": "Vanguard",
        "level": 10,
        "vigor": 15,
        "mind": 9,
        "endurance": 14,
        "strength": 15,
        "dexterity": 15,
        "intelligence": 7,
        "faith": 8,
        "arcane": 6,
    },
    2: {
        "name": "Marksman",
        "level": 11,
        "vigor": 13,
        "mind": 10,
        "endurance": 14,
        "strength": 13,
        "dexterity": 15,
        "intelligence": 9,
        "faith": 7,
        "arcane": 9,
    },
    3: {
        "name": "Berserker",
        "level": 7,
        "vigor": 14,
        "mind": 9,
        "endurance": 12,
        "strength": 18,
        "dexterity": 9,
        "intelligence": 7,
        "faith": 7,
        "arcane": 10,
    },
    4: {
        "name": "Dreadnought",
        "level": 10,
        "vigor": 16,
        "mind": 9,
        "endurance": 15,
        "strength": 17,
        "dexterity": 11,
        "intelligence": 6,
        "faith": 7,
        "arcane": 8,
    },
    5: {
        "name": "Sellsword",
        "level": 8,
        "vigor": 13,
        "mind": 10,
        "endurance": 12,
        "strength": 10,
        "dexterity": 17,
        "intelligence": 8,
        "faith": 8,
        "arcane": 9,
    },
    6: {
        "name": "Rogue",
        "level": 9,
        "vigor": 11,
        "mind": 12,
        "endurance": 12,
        "strength": 9,
        "dexterity": 18,
        "intelligence": 9,
        "faith": 8,
        "arcane": 9,
    },
    7: {
        "name": "Astrologer",
        "level": 6,
        "vigor": 9,
        "mind": 15,
        "endurance": 9,
        "strength": 8,
        "dexterity": 12,
        "intelligence": 16,
        "faith": 7,
        "arcane": 9,
    },
    8: {
        "name": "Starcaller",
        "level": 9,
        "vigor": 11,
        "mind": 12,
        "endurance": 11,
        "strength": 14,
        "dexterity": 11,
        "intelligence": 14,
        "faith": 6,
        "arcane": 9,
    },
    9: {
        "name": "Dragon Mage",
        "level": 9,
        "vigor": 11,
        "mind": 12,
        "endurance": 11,
        "strength": 11,
        "dexterity": 14,
        "intelligence": 14,
        "faith": 6,
        "arcane": 9,
    },
    10: {
        "name": "Volcanist",
        "level": 11,
        "vigor": 11,
        "mind": 15,
        "endurance": 8,
        "strength": 8,
        "dexterity": 10,
        "intelligence": 15,
        "faith": 15,
        "arcane": 8,
    },
    11: {
        "name": "Storm Caller",
        "level": 12,
        "vigor": 13,
        "mind": 12,
        "endurance": 10,
        "strength": 10,
        "dexterity": 10,
        "intelligence": 14,
        "faith": 14,
        "arcane": 8,
    },
    12: {
        "name": "Nox Oracle",
        "level": 14,
        "vigor": 11,
        "mind": 14,
        "endurance": 10,
        "strength": 9,
        "dexterity": 13,
        "intelligence": 14,
        "faith": 14,
        "arcane": 8,
    },
    13: {
        "name": "Necromancer",
        "level": 15,
        "vigor": 10,
        "mind": 16,
        "endurance": 8,
        "strength": 9,
        "dexterity": 9,
        "intelligence": 16,
        "faith": 16,
        "arcane": 10,
    },
    14: {
        "name": "Frost Witch",
        "level": 9,
        "vigor": 11,
        "mind": 15,
        "endurance": 9,
        "strength": 8,
        "dexterity": 10,
        "intelligence": 14,
        "faith": 7,
        "arcane": 14,
    },
    15: {
        "name": "Aberrant Heretic",
        "level": 10,
        "vigor": 10,
        "mind": 12,
        "endurance": 10,
        "strength": 10,
        "dexterity": 10,
        "intelligence": 15,
        "faith": 7,
        "arcane": 15,
    },
    16: {
        "name": "Flame Prophet",
        "level": 7,
        "vigor": 10,
        "mind": 14,
        "endurance": 8,
        "strength": 10,
        "dexterity": 10,
        "intelligence": 7,
        "faith": 17,
        "arcane": 10,
    },
    17: {
        "name": "Fundamentalist",
        "level": 8,
        "vigor": 10,
        "mind": 13,
        "endurance": 10,
        "strength": 11,
        "dexterity": 11,
        "intelligence": 6,
        "faith": 18,
        "arcane": 8,
    },
    18: {
        "name": "Bestial Devout",
        "level": 9,
        "vigor": 13,
        "mind": 12,
        "endurance": 11,
        "strength": 14,
        "dexterity": 9,
        "intelligence": 7,
        "faith": 16,
        "arcane": 6,
    },
    19: {
        "name": "Dragon Cultist",
        "level": 10,
        "vigor": 13,
        "mind": 11,
        "endurance": 10,
        "strength": 13,
        "dexterity": 13,
        "intelligence": 6,
        "faith": 16,
        "arcane": 7,
    },
    20: {
        "name": "Godskin Celebrant",
        "level": 11,
        "vigor": 10,
        "mind": 16,
        "endurance": 9,
        "strength": 10,
        "dexterity": 9,
        "intelligence": 14,
        "faith": 14,
        "arcane": 8,
    },
    21: {
        "name": "Frenzied Zealot",
        "level": 12,
        "vigor": 9,
        "mind": 14,
        "endurance": 12,
        "strength": 8,
        "dexterity": 10,
        "intelligence": 15,
        "faith": 15,
        "arcane": 8,
    },
    22: {
        "name": "Blood Initiate",
        "level": 11,
        "vigor": 13,
        "mind": 13,
        "endurance": 9,
        "strength": 9,
        "dexterity": 10,
        "intelligence": 8,
        "faith": 14,
        "arcane": 14,
    },
    23: {
        "name": "Servant of Rot",
        "level": 12,
        "vigor": 10,
        "mind": 11,
        "endurance": 11,
        "strength": 9,
        "dexterity": 12,
        "intelligence": 8,
        "faith": 15,
        "arcane": 15,
    },
    24: {
        "name": "Mystic",
        "level": 13,
        "vigor": 12,
        "mind": 12,
        "endurance": 8,
        "strength": 12,
        "dexterity": 8,
        "intelligence": 8,
        "faith": 16,
        "arcane": 16,
    },
    25: {
        "name": "Perfumer",
        "level": 5,
        "vigor": 10,
        "mind": 11,
        "endurance": 10,
        "strength": 9,
        "dexterity": 13,
        "intelligence": 9,
        "faith": 7,
        "arcane": 15,
    },
    26: {
        "name": "Prisoner",
        "level": 1,
        "vigor": 10,
        "mind": 10,
        "endurance": 10,
        "strength": 10,
        "dexterity": 10,
        "intelligence": 10,
        "faith": 10,
        "arcane": 10,
    },
}


def get_class_data(archetype: int, is_convergence: bool = False) -> dict:
    """
    Get starting class data by archetype ID.

    Args:
        archetype: Class archetype ID (0-9 for vanilla, 0-26 for Convergence)
        is_convergence: If True, use Convergence mod classes; otherwise vanilla

    Returns:
        Dictionary with class name and base stats
    """
    classes = CONVERGENCE_STARTING_CLASSES if is_convergence else STARTING_CLASSES
    default_archetype = (
        26 if is_convergence else 9
    )  # Prisoner for Convergence, Wretch for vanilla
    return classes.get(archetype, classes[default_archetype])


def calculate_level_from_stats(
    vigor: int,
    mind: int,
    endurance: int,
    strength: int,
    dexterity: int,
    intelligence: int,
    faith: int,
    arcane: int,
    archetype: int = 9,
    is_convergence: bool = False,
) -> int:
    """
    Calculate character level from stats based on starting class.

    Args:
        is_convergence: If True, use Convergence mod class as base; otherwise vanilla
    """
    base_class = get_class_data(archetype, is_convergence)

    total_points = (
        (vigor - base_class["vigor"])
        + (mind - base_class["mind"])
        + (endurance - base_class["endurance"])
        + (strength - base_class["strength"])
        + (dexterity - base_class["dexterity"])
        + (intelligence - base_class["intelligence"])
        + (faith - base_class["faith"])
        + (arcane - base_class["arcane"])
    )

    return base_class["level"] + total_points
